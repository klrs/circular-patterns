(this.webpackJsonpcircular_patterns=this.webpackJsonpcircular_patterns||[]).push([[0],{102:function(t,e,n){},103:function(t,e,n){},105:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n(2),s=n.n(i),r=n(21),c=n.n(r),o=(n(102),n(5)),l=n(6),h=n(3),u=n(10),d=n(9),p=(n(103),n(4)),v=n.n(p),f=n(33),x=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(o.a)(this,n),(a=e.call(this,t)).onPlay=a.onPlay.bind(Object(h.a)(a)),a.onClear=a.onClear.bind(Object(h.a)(a)),a.state={canvasRef:s.a.createRef(),orientation:0,centerPos:null},a}return Object(l.a)(n,[{key:"nextPos",value:function(t){return{x:this.state.centerPos.x+this.props.data.get(t)*Math.cos(2*t*Math.PI),y:this.state.centerPos.y-this.props.data.get(t)*Math.sin(2*t*Math.PI)}}},{key:"componentDidMount",value:function(){this.props.setPlay(this.onPlay),this.props.setClear(this.onClear);var t={x:this.state.canvasRef.current.width/2,y:this.state.canvasRef.current.height/2};this.setState({centerPos:t});this.state.canvasRef.current.getContext("2d")}},{key:"componentDidUpdate",value:function(){this.state.canvasRef.current.getContext("2d").lineTo(this.nextPos(this.state.orientation).x,this.nextPos(this.state.orientation).y)}},{key:"resetPath",value:function(t){}},{key:"onPlay",value:function(){var t=Object(f.a)(v.a.mark((function t(){var e,n,a,i,s,r=this;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.state.canvasRef.current.getContext("2d"),a=200*(n=.01),e.moveTo(this.state.canvasRef.current.width/2,this.state.canvasRef.current.height/2),e.beginPath(),i=v.a.mark((function t(n){var i,s,c;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=performance.now(),n>1?r.setState({orientation:1}):r.setState({orientation:n}),e.stroke(),s=performance.now(),!((c=s-i)<a)){t.next=8;break}return t.next=8,new Promise((function(t){return setTimeout(t,a-c)}));case 8:case"end":return t.stop()}}),t)})),s=0;case 7:if(!(s<=1+n)){t.next=12;break}return t.delegateYield(i(s),"t0",9);case 9:s+=n,t.next=7;break;case 12:this.resetPath(e);case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"onClear",value:function(){var t=this.state.canvasRef.current.getContext("2d");this.resetPath(t),t.clearRect(0,0,this.state.canvasRef.current.width,this.state.canvasRef.current.height)}},{key:"render",value:function(){return Object(a.jsx)("div",{className:"Canvas",children:Object(a.jsxs)("div",{children:[Object(a.jsx)("canvas",{ref:this.state.canvasRef,height:650,width:720}),Object(a.jsxs)("div",{className:"ButtonContainer",children:[Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:this.onPlay,children:"PLAY"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:this.onClear,children:"CLEAR"})})]})]})})}}]),n}(s.a.Component),y=n(1),j=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(o.a)(this,n),(a=e.call(this,t)).margin={top:20,right:30,bottom:20,left:30},a.width=720,a.height=650,a.xScale=null,a.yScale=null,a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.xScale=this.getXScaleFun(),this.yScale=this.getYScaleFun(),this.drawChart(),this.drawPath()}},{key:"componentDidUpdate",value:function(){this.xScale=this.getXScaleFun(),this.yScale=this.getYScaleFun(),this.drawChart(),this.drawPath()}},{key:"getXScaleFun",value:function(){return y.h().domain([this.props.xMin,this.props.xMax]).range([0+this.margin.right,this.width-this.margin.left]).clamp(!0)}},{key:"getYScaleFun",value:function(){return y.h().domain([this.props.yMin,this.props.yMax]).range([this.height-this.margin.bottom,0+this.margin.top])}},{key:"drawPath",value:function(){var t=this,e=y.f().x((function(e){return t.xScale(e.x)})).y((function(e){return t.yScale(e.y)})),n=y.e().on("drag",(function(e,n){t.props.onChange(n.value.p.x,t.yScale.invert(e.y))})),a=y.i("svg"),i=t.props.data.toSortedList().map((function(t){return{x:t.value.p.x,y:t.value.p.y}}));console.log(i),a.selectAll("#pathPoints").remove(),console.log("addPoints(): ",t.props.data.pointList),a.selectAll("pathCircles").data(t.props.data.toList()).enter().append("circle").attr("id","pathPoints").attr("cx",(function(e){return t.xScale(e.value.p.x)})).attr("cy",(function(e){return t.yScale(e.value.p.y)})).attr("fill","red").attr("r",6).on("mouseover",(function(t){y.i(this).attr("stroke","black").attr("stroke-width",4)})).on("mouseout",(function(t){y.i(this).attr("stroke","none")})).call(n).on("click",(function(t){t.defaultPrevented})),a.selectAll("#dataPath").remove();a.append("path").attr("id","dataPath").datum(i).attr("d",e).attr("fill","none").attr("stroke","red").attr("stroke-width",2)}},{key:"drawChart",value:function(){var t=this,e=y.i("svg");y.i("rect").on("click",(function(e){t.props.onAdd(t.xScale.invert(y.g(e)[0]),t.yScale.invert(y.g(e)[1]))})),e.selectAll(".axes").remove(),e.selectAll(".grid").remove(),e.append("g").attr("class","axes").attr("transform","translate(0,".concat(t.margin.top,")")).call(y.d(t.xScale)),e.append("g").attr("class","axes").attr("transform","translate(".concat(t.margin.left,",0)")).call(y.b(t.yScale)),e.append("g").attr("class","grid").attr("transform","translate(0, ".concat(t.margin.top,")")).call(y.a(t.xScale).ticks(5).tickFormat("").tickSize(t.height-t.margin.top-t.margin.bottom)),e.append("g").attr("class","grid").attr("transform","translate(".concat(t.margin.left,",0)")).call(y.c(t.yScale).ticks(5).tickFormat("").tickSize(t.width-t.margin.left-t.margin.right))}},{key:"render",value:function(){return Object(a.jsxs)("div",{className:"Graph",children:[Object(a.jsx)("svg",{height:this.height,width:this.width,children:Object(a.jsx)("g",{children:Object(a.jsx)("rect",{fill:"#d6d6d6",height:this.height,width:this.width})})}),Object(a.jsxs)("div",{className:"ButtonContainer",children:[Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:this.props.onReverse,children:"REVERSE"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:this.props.onSnap,children:"SNAP"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:this.props.onDefault,children:"DEFAULT"})})]})]})}}]),n}(s.a.Component),b=n(8),g=function(){function t(e,n,a){Object(o.a)(this,t),this.p={x:e,y:n},this.fun=a}return Object(l.a)(t,[{key:"copy",value:function(){return new t(this.p.x,this.p.y,this.fun.bind({}))}}]),t}(),O=function(){function t(e,n){Object(o.a)(this,t),this.pointList=e,n&&(console.log("Initializing pointList."),this.add({x:1,y:10},"constant"),this.add({x:0,y:10},"linear")),console.log("Constructed pointList: ",this.pointList)}return Object(l.a)(t,[{key:"copy",value:function(){for(var e={},n=0,a=Object.entries(this.pointList);n<a.length;n++){var i=Object(b.a)(a[n],2),s=i[0],r=i[1];e[s]=r.copy()}return new t(e,!1)}},{key:"reverse",value:function(){for(var e=new t({},!1),n=0,a=Object.entries(this.pointList);n<a.length;n++){var i=Object(b.a)(a[n],2),s=i[0],r=i[1];0===s?e.add({x:1-r.p.x,y:r.p.y},"constant"):e.add({x:1-r.p.x,y:r.p.y},"linear")}return e}},{key:"snap",value:function(){for(var e=this.pointList[1].p.y-this.pointList[0].p.y,n=new t({},!1),a=0,i=Object.entries(this.pointList);a<i.length;a++){var s=Object(b.a)(i[a],2),r=s[0],c=s[1];1===r&&n.add({x:c.p.x,y:c.p.y+e},"constant"),n.add({x:c.p.x,y:c.p.y+e},"linear")}return console.log(n),n}},{key:"toList",value:function(){for(var t=[],e=0,n=Object.entries(this.pointList);e<n.length;e++){var a=Object(b.a)(n[e],2),i=a[0],s=a[1];t.push({value:s,index:i})}return t}},{key:"toSortedList",value:function(){var t=this.toList().sort((function(t,e){return t.index<e.index?-1:t.index>e.index?1:0}));return console.log("sortedList:",t),t}},{key:Symbol.iterator,value:function(){return this.pointList.values()}},{key:"get",value:function(t){var e=this.findPrevPoint(t);return null===e?this.pointList[0].fun(t):e.value.fun(t)}},{key:"replace",value:function(t,e,n){var a={x:this.pointList[t].p.x,y:e};this.add(a,n),console.log("Post-replace pointList: ",this.pointList)}},{key:"add",value:function(t,e){var n;switch(null===this.findNextPoint(t.x)&&(e="constant"),e){case"linear":var a=this.findNextPoint(t.x).value.p;n=function(e){return(e-t.x)*(a.y-t.y)/(a.x-t.x)+t.y};break;case"constant":n=function(e){return t.y};break;case"none":n=function(t){return 0};break;case"sine":default:console.log("Function type not supported. Using default function."),n=function(t){return 10}}this.pointList[t.x]=new g(t.x,t.y,n);var i=this.findPrevPoint(t.x);null!==i&&this.replace(i.index,i.value.p.y,"linear")}},{key:"getScale",value:function(){return{min:this.pointList[1].p.y-50,max:this.pointList[1].p.y+50}}},{key:"findNextPoint",value:function(t){for(var e=null,n=0,a=Object.entries(this.pointList);n<a.length;n++){var i=Object(b.a)(a[n],2),s=i[0],r=i[1];t<r.p.x&&(null===e||r.p.x<e.value.p.x)&&(e={value:r,index:s})}return e}},{key:"findPrevPoint",value:function(t,e){for(var n=null,a=0,i=Object.entries(this.pointList);a<i.length;a++){var s=Object(b.a)(i[a],2),r=s[0],c=s[1];t>c.p.x&&(null===n||c.p.x>n.value.p.x)&&(n={value:c,index:r})}return n}}]),t}();var k=function(t){return Object(a.jsxs)("div",{className:"HeadBar",children:[Object(a.jsx)("div",{id:"logo",children:Object(a.jsx)("b",{children:"CIRCULAR PATTERNS"})}),Object(a.jsx)("div",{id:"header",children:"2021 Kalle Rissanen"})]})},S=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(o.a)(this,n),(a=e.call(this,t)).onChange=a.onChange.bind(Object(h.a)(a)),a.onAdd=a.onAdd.bind(Object(h.a)(a)),a.onReverse=a.onReverse.bind(Object(h.a)(a)),a.onSnap=a.onSnap.bind(Object(h.a)(a)),a.onDefault=a.onDefault.bind(Object(h.a)(a)),a.onNavigation=a.onNavigation.bind(Object(h.a)(a)),a.state={data:new O({},!0),yScaleMin:-50,yScaleMax:50,view:"canvas"},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"onChange",value:function(t,e){this.state.data.replace(t,e,"linear"),this.setState({data:this.state.data.copy()})}},{key:"onAdd",value:function(t,e){this.state.data.add({x:t,y:e},"linear"),this.setState({data:this.state.data.copy()})}},{key:"onReverse",value:function(){this.setState({data:this.state.data.reverse()})}},{key:"onSnap",value:function(){console.log("scale:"+this.state.yScaleMin+" "+this.state.yScaleMax),this.setState({data:this.state.data.snap(),yScaleMin:this.state.data.getScale().min,yScaleMax:this.state.data.getScale().max}),console.log("scale:"+this.state.yScaleMin+" "+this.state.yScaleMax)}},{key:"onDefault",value:function(){this.setState({data:new O({},!0),yScaleMin:-50,yScaleMax:50})}},{key:"onNavigation",value:function(t){this.setState({view:t})}},{key:"render",value:function(){var t=this;return"canvas"===this.state.view?Object(a.jsx)(x,{data:this.state.data,setPlay:function(e){return t.playCanvas=e},setClear:function(e){return t.clearCanvas=e}}):"graph"===this.state.view&&Object(a.jsx)(j,{data:this.state.data,onChange:this.onChange,onAdd:this.onAdd,xMin:0,xMax:1,yMin:this.state.yScaleMin,yMax:this.state.yScaleMax}),Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(k,{onNavigation:this.onNavigation}),Object(a.jsx)("div",{className:"Body",children:Object(a.jsxs)("div",{className:"Meat",children:[Object(a.jsx)(x,{data:this.state.data,setPlay:function(e){return t.playCanvas=e},setClear:function(e){return t.clearCanvas=e}}),Object(a.jsx)(j,{data:this.state.data,onChange:this.onChange,onAdd:this.onAdd,xMin:0,xMax:1,yMin:this.state.yScaleMin,yMax:this.state.yScaleMax,onReverse:this.onReverse,onSnap:this.onSnap,onDefault:this.onDefault})]})})]})}}]),n}(s.a.Component),m=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,106)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,s=e.getLCP,r=e.getTTFB;n(t),a(t),i(t),s(t),r(t)}))};c.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(S,{})}),document.getElementById("root")),m()}},[[105,1,2]]]);
//# sourceMappingURL=main.2f8761f0.chunk.js.map