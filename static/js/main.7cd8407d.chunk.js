(this.webpackJsonpcircular_patterns=this.webpackJsonpcircular_patterns||[]).push([[0],{103:function(t,e,n){},104:function(t,e,n){},106:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n(2),s=n.n(i),r=n(22),o=n.n(r),c=(n(103),n(4)),l=n(6),h=n(7),u=n(3),d=n(11),p=n(10),v=(n(104),n(5)),f=n.n(v),g=n(34);var x=function(t){Object(d.a)(n,t);var e=Object(p.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).onPlay=a.onPlay.bind(Object(u.a)(a)),a.onClear=a.onClear.bind(Object(u.a)(a)),a.onSave=a.onSave.bind(Object(u.a)(a)),a.state={canvasRef:s.a.createRef(),orientation:0,centerPos:null},a}return Object(h.a)(n,[{key:"nextPos",value:function(t){var e=this.props.degreeData.get(t)/360*2*Math.PI;return{x:this.state.centerPos.x+this.props.radiusData.get(t)*Math.cos(e),y:this.state.centerPos.y-this.props.radiusData.get(t)*Math.sin(e)}}},{key:"componentDidMount",value:function(){this.props.setPlay(this.onPlay),this.props.setClear(this.onClear);var t={x:this.state.canvasRef.current.width/2,y:this.state.canvasRef.current.height/2};this.setState({centerPos:t});this.state.canvasRef.current.getContext("2d")}},{key:"componentDidUpdate",value:function(){this.state.canvasRef.current.getContext("2d").lineTo(this.nextPos(this.state.orientation).x,this.nextPos(this.state.orientation).y)}},{key:"resetPath",value:function(t){}},{key:"onPlay",value:function(){var t=Object(g.a)(f.a.mark((function t(){var e,n,a,i,s,r=this;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.state.canvasRef.current.getContext("2d"),a=200*(n=.01),e.moveTo(this.state.canvasRef.current.width/2,this.state.canvasRef.current.height/2),e.beginPath(),i=f.a.mark((function t(n){var i,s,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=performance.now(),n>1?r.setState({orientation:1}):r.setState({orientation:n}),e.stroke(),s=performance.now(),!((o=s-i)<a)){t.next=8;break}return t.next=8,new Promise((function(t){return setTimeout(t,a-o)}));case 8:case"end":return t.stop()}}),t)})),s=0;case 7:if(!(s<=1+n)){t.next=12;break}return t.delegateYield(i(s),"t0",9);case 9:s+=n,t.next=7;break;case 12:this.resetPath(e);case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"onClear",value:function(){var t=this.state.canvasRef.current.getContext("2d");this.resetPath(t),t.clearRect(0,0,this.state.canvasRef.current.width,this.state.canvasRef.current.height)}},{key:"onSave",value:function(){var t=document.createElement("a");t.download="canvas.png",t.href=this.state.canvasRef.current.toDataURL("image/png"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}},{key:"render",value:function(){return Object(a.jsx)("div",{className:"Canvas",children:Object(a.jsxs)("div",{children:[Object(a.jsx)("canvas",{ref:this.state.canvasRef,height:this.props.height,width:this.props.width}),Object(a.jsxs)("div",{className:"ButtonContainer",children:[Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:this.onPlay,children:"PLAY"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:this.onClear,children:"CLEAR"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:this.onSave,children:"SAVE"})})]})]})})}}]),n}(s.a.Component),y=n(1),b=function(t){Object(d.a)(n,t);var e=Object(p.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).margin={top:20,right:30,bottom:20,left:30},a.width=t.width,a.height=t.height,a.xScale=null,a.yScale=null,a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.xScale=this.getXScaleFun(),this.yScale=this.getYScaleFun(),this.drawChart(),this.drawPath()}},{key:"componentDidUpdate",value:function(){this.xScale=this.getXScaleFun(),this.yScale=this.getYScaleFun(),this.drawChart(),this.drawPath()}},{key:"getXScaleFun",value:function(){return y.h().domain([this.props.xMin,this.props.xMax]).range([0+this.margin.right,this.width-this.margin.left]).clamp(!0)}},{key:"getYScaleFun",value:function(){return y.h().domain([this.props.yMin,this.props.yMax]).range([this.height-this.margin.bottom,0+this.margin.top])}},{key:"drawPath",value:function(){var t=this,e=y.f().x((function(e){return t.xScale(e.x)})).y((function(e){return t.yScale(e.y)})),n=y.e().on("drag",(function(e,n){t.props.onChange(n.value.p.x,t.yScale.invert(e.y),t.props.data)})),a=y.i("svg"),i=t.props.data.toSortedList().map((function(t){return{x:t.value.p.x,y:t.value.p.y}}));console.log(i),a.selectAll("#pathPoints").remove(),console.log("addPoints(): ",t.props.data.pointList),a.selectAll("pathCircles").data(t.props.data.toList()).enter().append("circle").attr("id","pathPoints").attr("cx",(function(e){return t.xScale(e.value.p.x)})).attr("cy",(function(e){return t.yScale(e.value.p.y)})).attr("fill",t.props.color).attr("r",6).on("mouseover",(function(t){y.i(this).attr("stroke","black").attr("stroke-width",4)})).on("mouseout",(function(t){y.i(this).attr("stroke","none")})).call(n).on("click",(function(t){t.defaultPrevented})),a.selectAll("#dataPath").remove();a.append("path").attr("id","dataPath").datum(i).attr("d",e).attr("fill","none").attr("stroke",this.props.color).attr("stroke-width",2)}},{key:"drawChart",value:function(){var t=this,e=y.i("svg");y.i("rect").on("click",(function(e){t.props.onAdd(t.xScale.invert(y.g(e)[0]),t.yScale.invert(y.g(e)[1]),t.props.data)})),e.selectAll(".axes").remove(),e.selectAll(".grid").remove(),e.append("g").attr("class","axes").attr("transform","translate(0,".concat(t.margin.top,")")).call(y.d(t.xScale)),e.append("g").attr("class","axes").attr("transform","translate(".concat(t.margin.left,",0)")).call(y.b(t.yScale)),e.append("g").attr("class","grid").attr("transform","translate(0, ".concat(t.margin.top,")")).call(y.a(t.xScale).ticks(5).tickFormat("").tickSize(t.height-t.margin.top-t.margin.bottom)),e.append("g").attr("class","grid").attr("transform","translate(".concat(t.margin.left,",0)")).call(y.c(t.yScale).ticks(5).tickFormat("").tickSize(t.width-t.margin.left-t.margin.right))}},{key:"render",value:function(){var t=this;return Object(a.jsxs)("div",{className:"Graph",children:[Object(a.jsx)("svg",{height:this.height,width:this.width,children:Object(a.jsx)("g",{children:Object(a.jsx)("rect",{fill:"#d6d6d6",height:this.height,width:this.width})})}),Object(a.jsxs)("div",{className:"ButtonContainer",children:[Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:function(){t.props.onReverse(t.props.data)},children:"REVERSE"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:function(){t.props.onSnap(t.props.data)},children:"SNAP"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:function(){t.props.onDefault(t.props.data)},children:"DEFAULT"})})]})]})}}]),n}(s.a.Component),j=n(9),m=function(){function t(e,n,a){Object(l.a)(this,t),this.p={x:e,y:n},this.fun=a}return Object(h.a)(t,[{key:"copy",value:function(){return new t(this.p.x,this.p.y,this.fun.bind({}))}}]),t}(),O=function(){function t(e,n,a,i,s){Object(l.a)(this,t),this.pointList=e,this.id=a,this.startValues={y0:i,y1:s},n&&(console.log("Initializing pointList."),this.add({x:1,y:s},"constant"),this.add({x:0,y:i},"linear")),console.log("Constructed pointList: ",this.pointList)}return Object(h.a)(t,[{key:"copy",value:function(){for(var e={},n=0,a=Object.entries(this.pointList);n<a.length;n++){var i=Object(j.a)(a[n],2),s=i[0],r=i[1];e[s]=r.copy()}return new t(e,!1,this.id,this.startValues.y0,this.startValues.y1)}},{key:"emptyCopy",value:function(){return new t({},!1,this.id,this.startValues.y0,this.startValues.y1)}},{key:"resetCopy",value:function(){return new t({},!0,this.id,this.startValues.y0,this.startValues.y1)}},{key:"reverse",value:function(){for(var t=this.emptyCopy(),e=0,n=Object.entries(this.pointList);e<n.length;e++){var a=Object(j.a)(n[e],2),i=a[0],s=a[1];0===i?t.add({x:1-s.p.x,y:s.p.y},"constant"):t.add({x:1-s.p.x,y:s.p.y},"linear")}return t}},{key:"snap",value:function(){for(var t=this.pointList[1].p.y-this.pointList[0].p.y,e=this.emptyCopy(),n=0,a=Object.entries(this.pointList);n<a.length;n++){var i=Object(j.a)(a[n],2),s=i[0],r=i[1];1===s&&e.add({x:r.p.x,y:r.p.y+t},"constant"),e.add({x:r.p.x,y:r.p.y+t},"linear")}return console.log(e),e}},{key:"toList",value:function(){for(var t=[],e=0,n=Object.entries(this.pointList);e<n.length;e++){var a=Object(j.a)(n[e],2),i=a[0],s=a[1];t.push({value:s,index:i})}return t}},{key:"toSortedList",value:function(){var t=this.toList().sort((function(t,e){return t.index<e.index?-1:t.index>e.index?1:0}));return console.log("sortedList:",t),t}},{key:Symbol.iterator,value:function(){return this.pointList.values()}},{key:"get",value:function(t){var e=this.findPrevPoint(t);return null===e?this.pointList[0].fun(t):e.value.fun(t)}},{key:"replace",value:function(t,e,n){var a={x:this.pointList[t].p.x,y:e};this.add(a,n),console.log("Post-replace pointList: ",this.pointList)}},{key:"add",value:function(t,e){var n;switch(null===this.findNextPoint(t.x)&&(e="constant"),e){case"linear":var a=this.findNextPoint(t.x).value.p;n=function(e){return(e-t.x)*(a.y-t.y)/(a.x-t.x)+t.y};break;case"constant":n=function(e){return t.y};break;case"none":n=function(t){return 0};break;case"sine":default:console.log("Function type not supported. Using default function."),n=function(t){return 10}}this.pointList[t.x]=new m(t.x,t.y,n);var i=this.findPrevPoint(t.x);null!==i&&this.replace(i.index,i.value.p.y,"linear")}},{key:"getScale",value:function(){return{min:this.get(.5)-this.startValues.y1,max:this.get(.5)+this.startValues.y1}}},{key:"findNextPoint",value:function(t){for(var e=null,n=0,a=Object.entries(this.pointList);n<a.length;n++){var i=Object(j.a)(a[n],2),s=i[0],r=i[1];t<r.p.x&&(null===e||r.p.x<e.value.p.x)&&(e={value:r,index:s})}return e}},{key:"findPrevPoint",value:function(t,e){for(var n=null,a=0,i=Object.entries(this.pointList);a<i.length;a++){var s=Object(j.a)(i[a],2),r=s[0],o=s[1];t>o.p.x&&(null===n||o.p.x>n.value.p.x)&&(n={value:o,index:r})}return n}}]),t}();var k=function(t){return Object(a.jsxs)("div",{className:"HeadBar",children:[Object(a.jsx)("div",{id:"logo",children:Object(a.jsx)("b",{children:"CIRCULAR PATTERNS by Kalle Rissanen"})}),Object(a.jsx)("div",{id:"parameter",children:Object(a.jsxs)("button",{onClick:t.onViewChange,children:["PARAMETER: ",t.parameter.toUpperCase()]})})]})},S=function(t){Object(d.a)(n,t);var e=Object(p.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).onChange=a.onChange.bind(Object(u.a)(a)),a.onAdd=a.onAdd.bind(Object(u.a)(a)),a.onReverse=a.onReverse.bind(Object(u.a)(a)),a.onSnap=a.onSnap.bind(Object(u.a)(a)),a.onDefault=a.onDefault.bind(Object(u.a)(a)),a.onViewChange=a.onViewChange.bind(Object(u.a)(a)),a.state={radiusData:new O({},!0,"radiusData",50,50),radiusDataScale:{min:0,max:0},degreeData:new O({},!0,"degreeData",0,360),degreeDataScale:{min:0,max:0},view:"radius"},a.sideLength=a.getSideLength(),console.log(a.sideLength),a}return Object(h.a)(n,[{key:"getSideLength",value:function(){return window.innerWidth>720?.35*window.innerWidth:window.innerWidth}},{key:"componentDidMount",value:function(){this.setState({radiusDataScale:this.state.radiusData.getScale(),degreeDataScale:this.state.degreeData.getScale()})}},{key:"componentDidUpdate",value:function(){}},{key:"onChange",value:function(t,e,n){n.replace(t,e,"linear"),this.setState(Object(c.a)({},n.id,n.copy()))}},{key:"onAdd",value:function(t,e,n){n.add({x:t,y:e},"linear"),this.setState(Object(c.a)({},n.id,n.copy()))}},{key:"onReverse",value:function(t){console.log("onReverse called"),this.setState(Object(c.a)({},t.id,t.reverse()))}},{key:"onSnap",value:function(t){var e,n=t.snap();this.setState((e={},Object(c.a)(e,t.id,n),Object(c.a)(e,t.id+"Scale",n.getScale()),e))}},{key:"onDefault",value:function(t){var e,n=t.resetCopy();this.setState((e={},Object(c.a)(e,t.id,n),Object(c.a)(e,t.id+"Scale",n.getScale()),e))}},{key:"onViewChange",value:function(){var t;t="radius"===this.state.view?"degree":"radius",this.setState({view:t})}},{key:"render",value:function(){var t,e=this;return"radius"===this.state.view?t=Object(a.jsx)(b,{width:this.sideLength,height:this.sideLength,data:this.state.radiusData,onChange:this.onChange,onAdd:this.onAdd,color:"red",xMin:0,xMax:1,yMin:this.state.radiusDataScale.min,yMax:this.state.radiusDataScale.max,onReverse:this.onReverse,onSnap:this.onSnap,onDefault:this.onDefault}):"degree"===this.state.view&&(t=Object(a.jsx)(b,{width:this.sideLength,height:this.sideLength,data:this.state.degreeData,onChange:this.onChange,onAdd:this.onAdd,color:"blue",xMin:0,xMax:1,yMin:this.state.degreeDataScale.min,yMax:this.state.degreeDataScale.max,onReverse:this.onReverse,onSnap:this.onSnap,onDefault:this.onDefault})),Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(k,{onViewChange:this.onViewChange,parameter:this.state.view}),Object(a.jsx)("div",{className:"Body",children:Object(a.jsxs)("div",{className:"Meat",children:[Object(a.jsx)(x,{radiusData:this.state.radiusData,degreeData:this.state.degreeData,width:this.sideLength,height:this.sideLength,setPlay:function(t){return e.playCanvas=t},setClear:function(t){return e.clearCanvas=t}}),t]})})]})}}]),n}(s.a.Component),w=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,107)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,s=e.getLCP,r=e.getTTFB;n(t),a(t),i(t),s(t),r(t)}))};o.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(S,{})}),document.getElementById("root")),w()}},[[106,1,2]]]);
//# sourceMappingURL=main.7cd8407d.chunk.js.map